!function(e){var t={};function i(s){if(t[s])return t[s].exports;var a=t[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(s,a,function(t){return e[t]}.bind(null,a));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=0)}([function(e,t,i){"use strict";function s(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}i.r(t);var a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.srcX=48,this.srcY=128,this.width=48,this.height=64,this.speed=10,this.xPos=t/2-this.width/2,this.yPos=i-this.height,this.radius=this.height/2,this.playerImg="src/images/thief48_64.png",this.speed=10,this.drawPlayer=this.drawPlayer.bind(this),this.movePlayer=this.movePlayer.bind(this)}var t,i,a;return t=e,(i=[{key:"drawPlayer",value:function(e){var t=new Image;t.src=this.playerImg,e.drawImage(t,this.srcX,this.srcY,this.width,this.height,this.xPos,this.yPos,this.width,this.height)}},{key:"movePlayer",value:function(e,t,i){switch(i.key){case"ArrowRight":this.xPos<e-this.width&&(this.xPos+=this.speed);break;case"ArrowLeft":this.xPos>-10&&(this.xPos-=this.speed);break;case"ArrowUp":this.yPos>-30&&(this.yPos-=this.speed);break;case"ArrowDown":this.yPos<t-this.height&&(this.yPos+=this.speed)}}}])&&s(t.prototype,i),a&&s(t,a),e}();function n(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var r=function(){function e(t,i,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.srcX=0,this.srcY=0,this.width=30,this.height=30,this.xPos=Math.floor(Math.random()*(t-100)),this.yPos=Math.ceil(Math.random()*i/6),this.itemImg="src/images/broadsword.png",this.xDir=Math.random()>.5?-1:1,this.yDir=Math.random()>.5?-1:1,this.xVel=(Math.floor(Math.random()*s)+2+s)*this.xDir,this.yVel=this.xVel*this.yDir,this.drawItem=this.drawItem.bind(this),this.moveItem=this.moveItem.bind(this)}var t,i,s;return t=e,(i=[{key:"drawItem",value:function(e){var t=new Image;t.src=this.itemImg,e.drawImage(t,this.srcX,this.srcY,this.width,this.height,this.xPos,this.yPos,this.width,this.height)}},{key:"moveItem",value:function(e,t,i){this.xPos+this.xVel>=t-this.width?this.xVel=-Math.abs(this.xVel):this.xPos-this.xVel<=0&&(this.xVel=Math.abs(this.xVel)),this.yPos+this.yVel>=i-this.height?this.yVel=-Math.abs(this.yVel):this.yPos-this.yVel<=0&&(this.yVel=Math.abs(this.yVel)),this.xPos+=this.xVel,this.yPos+=this.yVel,this.drawItem(e)}}])&&n(t.prototype,i),s&&n(t,s),e}();function o(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var h=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=document.getElementsByClassName("canvas-mini-game")[0],this.canvas.width=300,this.canvas.height=300,this.ctx=this.canvas.getContext("2d"),this.bgSrc="src/images/background.png",this.bgImg=new Image,this.cWidth=this.canvas.width,this.cHeight=this.canvas.height,this.successMessage=document.getElementsByClassName("canvas-success")[0],this.failMessage=document.getElementsByClassName("canvas-fail")[0],this.miniGame=document.getElementsByClassName("minigame")[0],this.canvasMessageCont=document.getElementsByClassName("canvas-message-container")[0],this.difficulty=t,this.wCount=Math.ceil(Math.random()*t)+1+t,this.weaponCache=[],this.player=new a(this.cWidth,this.cHeight),this.gameOn=!1,this.mainGame=i,this.generateWeaponCache=this.generateWeaponCache.bind(this),this.drawBg=this.drawBg.bind(this),this.registerPlayerMoves=this.registerPlayerMoves.bind(this),this.animateGame=this.animateGame.bind(this),this.success=this.success.bind(this),this.ckCollision=this.ckCollision.bind(this),this.closeGame=this.closeGame.bind(this),this.showGame=this.showGame.bind(this)}var t,i,s;return t=e,(i=[{key:"generateWeaponCache",value:function(){for(var e=0;e<this.wCount;e++){var t=new r(this.cWidth,this.cHeight,this.difficulty);this.weaponCache.push(t)}}},{key:"drawBg",value:function(){this.bgImg.src="src/images/background.png",this.ctx.drawImage(this.bgImg,0,0,this.cWidth,this.cHeight),this.canvas.style.display="block"}},{key:"registerPlayerMoves",value:function(e){this.gameOn&&(this.player.movePlayer(this.cWidth,this.cHeight,e),this.player.drawPlayer(this.ctx))}},{key:"success",value:function(){return this.player.yPos+this.player.height/2<=0&&(this.gameOn=!1,!0)}},{key:"ckCollision",value:function(e){var t=e.xPos,i=e.xPos+e.width,s=e.yPos,a=e.yPos+e.height,n=this.player.xPos+this.player.width/2,r=this.player.yPos+this.player.height/2;return r<a&&r>s&&n<i&&n>t&&(this.gameOn=!1,this.mainGame.lifeCount-=1,document.dispatchEvent(new Event("life-update")),!0)}},{key:"animateGame",value:function(){var e=this;this.gameOn&&(this.ctx.clearRect(0,0,this.cWidth,this.cHeight),this.drawBg(),this.player.drawPlayer(this.ctx),this.weaponCache.forEach((function(t){t.moveItem(e.ctx,e.cWidth,e.cHeight),e.ckCollision(t)&&(e.failMessage.style.display="block",e.difficulty>1&&document.dispatchEvent(new Event("commander-msg")))})),this.success()&&(this.successMessage.style.display="block",this.difficulty>1&&document.dispatchEvent(new Event("commander-msg"))),this.gameOn&&requestAnimationFrame(this.animateGame))}},{key:"closeGame",value:function(e){"Escape"===e.key&&("block"===this.canvas.style.display&&(this.canvas.style.display="none",this.successMessage.style.display="none",this.failMessage.style.display="none",this.canvasMessageCont.style.display="none",this.miniGame.style.background="none"),this.gameOn=!1,this.mainGame.dodgeHits=null,this.mainGame.ckloseGame())}},{key:"showGame",value:function(e){"none"===this.canvas.style.display&&(this.canvas.style.display="block"),this.gameOn=!0}}])&&o(t.prototype,i),s&&o(t,s),e}();function c(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var l=function(){function e(t,i,s,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=document.getElementById("".concat(s,"-").concat(a)),this.ctx=this.canvas.getContext("2d"),this.canvas.width=60,this.canvas.height=100,this.r=s,this.c=a,this.value=t,this.width=60,this.height=100,this.suitImg=i,this.suitValue=document.getElementsByClassName("suit-value-[".concat(s,",").concat(a,"]"))[0],this.drawSuit=this.drawSuit.bind(this),this.displayMessage=this.displayMessage.bind(this)}var t,i,s;return t=e,(i=[{key:"drawSuit",value:function(){var e=this,t=new Image;t.src=this.suitImg,t.onload=function(){e.ctx.drawImage(t,0,0,e.width,e.height,0,0,e.canvas.width,e.canvas.height)}}},{key:"displayMessage",value:function(){switch(this.value){case"crown":this.suitValue.innerHTML="You found the crown!";break;case"commander":this.suitValue.innerHTML="You've been spotted by the Commander!! Prepare to run fast in 3 seconds!";break;case"queen":this.suitValue.innerHTML="The Queen is never far from the King. The crown should be on the same floor.";break;case"prince":this.suitValue.innerHTML="The Prince is yelling for his guards... You found a location of a guard.";break;case"guard":this.suitValue.innerHTML="You've been spotted by a guard! Prepare to run in 3 seconds!";break;case"maid":this.suitValue.innerHTML="You found a maid cleaning...";break;case"storage":this.suitValue.innerHTML="You found a storage room with supplies. You rest up and gain a life."}}}])&&c(t.prototype,i),s&&c(t,s),e}();function u(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var d=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.row=t,this.col=i,this.grid=this.makeGrid(t,i),this.roomMap={},this.roomKeys,this.makeGrid=this.makeGrid.bind(this),this.validComPos=this.validComPos.bind(this),this.validGenPos=this.validGenPos.bind(this),this.generateRandCrown=this.generateRandCrown.bind(this),this.generateRandCommander=this.generateRandCommander.bind(this),this.generateRandQueen=this.generateRandQueen.bind(this),this.shuffle=this.shuffle.bind(this),this.shuffle(this.row,this.col)}var t,i,s;return t=e,(i=[{key:"makeGrid",value:function(e,t){for(var i=[],s=[],a=0;a<e;a++){s.push([]);for(var n=0;n<t;n++)s[a].push(null),i.push([a,n])}return this.roomKeys=i,s}},{key:"generateRandCrown",value:function(e,t){var i=Math.floor(Math.random()*e),s=Math.floor(Math.random()*t),a=new l("crown","src/images/crown.png",i,s);return this.grid[i][s]=a,[i,s]}},{key:"generateRandCommander",value:function(e){var t=this,i=[];[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[1,-1],[1,0],[1,1]].forEach((function(s){var a=t.validComPos(e,s);a&&i.push(a)}));var s=Math.floor(Math.random()*i.length),a=i[s],n=new l("commander","src/images/commander.png",a[0],a[1]);this.grid[a[0]][a[1]]=n}},{key:"generateRandQueen",value:function(e){for(var t=[],i=0;i<this.col;i++){var s=[e,i];this.validGenPos(s)&&t.push(s)}var a=t[Math.floor(Math.random()*t.length)],n=new l("queen","src/images/queen.png",a[0],a[1]);this.grid[a[0]][a[1]]=n}},{key:"validComPos",value:function(e,t){var i=e[0]+t[0],s=e[1]+t[1];return!(i<0||i>=this.row||s<0||s>=this.col)&&[i,s]}},{key:"validGenPos",value:function(e){return null===this.grid[e[0]][e[1]]}},{key:"shuffle",value:function(e,t){var i=this,s=this.generateRandCrown(e,t);this.generateRandCommander(s),this.generateRandQueen(s[0]);for(var a=["prince","guard","guard","guard","guard","guard","guard","maid","maid","maid","storage","storage"],n=0;n<a.length-1;n++){var r=Math.floor(Math.random()*n),o=[a[r],a[n]];a[n]=o[0],a[r]=o[1]}this.roomKeys.forEach((function(e){var t=e[0],s=e[1];if(null===i.grid[t][s]){var n=a.shift();i.populate(n,[t,s])}var r=i.grid[t][s].value;i.roomMap[r]||(i.roomMap[r]=[]),i.roomMap[r].push([t,s])}))}},{key:"populate",value:function(e,t){switch(e){case"prince":var i=new l("prince","src/images/prince-walk.png",t[0],t[1]);this.grid[t[0]][t[1]]=i;break;case"guard":var s=new l("guard","src/images/guard.png",t[0],t[1]);this.grid[t[0]][t[1]]=s;break;case"maid":var a=new l("maid","src/images/maid-rest.png",t[0],t[1]);this.grid[t[0]][t[1]]=a;break;case"storage":var n=new l("storage","src/images/storage.png",t[0],t[1]);this.grid[t[0]][t[1]]=n}}}])&&u(t.prototype,i),s&&u(t,s),e}();function m(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var g=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.board=new d(3,5),this.guardLocation=this.board.roomMap.guard,this.newGame=this.newGame.bind(this),this.openRoom=this.openRoom.bind(this),this.specialRooms=this.specialRooms.bind(this),this.ckloseGame=this.ckloseGame.bind(this),this.ckGameWin=this.ckGameWin.bind(this),this.playMiniGame=this.playMiniGame.bind(this)}var t,i,s;return t=e,(i=[{key:"newGame",value:function(){this.board=new d(3,5),this.lifeCount=2,this.guardLocation=this.board.roomMap.guard,this.currRoom=null,this.dodgeHits=null,document.dispatchEvent(new Event("life-update"))}},{key:"openRoom",value:function(e){var t=e.lastElementChild.lastElementChild.id,i=[parseInt(t[0]),parseInt(t[2])],s=i[0],a=i[1],n=this.board.grid[s][a];this.currRoom=n,n.drawSuit(),n.displayMessage();var r=-1;return this.guardLocation.forEach((function(e,t){e[0]===s&&e[1]===a&&(r=t)})),r>=0&&this.guardLocation.splice(r,1),("guard"===n.value||"commander"===n.value||"storage"===n.value||"crown"===n.value||"prince"===n.value)&&n.value}},{key:"specialRooms",value:function(e){switch(e){case"guard":this.dodgeHits=!0,this.playMiniGame(1,this);break;case"commander":this.dodgeHits=!0,this.playMiniGame(2,this);break;case"storage":this.lifeCount+=1,document.dispatchEvent(new Event("life-update"));break;case"crown":this.ckGameWin();break;case"prince":if(this.guardLocation.length>0){var t=this.guardLocation[0],i="".concat(t[0]),s="".concat(t[1]),a=document.getElementsByClassName("suit-value-[".concat(i,",").concat(s,"]"))[0];a.parentElement.parentElement.setAttribute("id","shown"),this.board.grid[t[0]][t[1]].drawSuit(),a.innerHTML="The prince revealed the location of a guard"}}}},{key:"playMiniGame",value:function(e,t){var i=this;this.dodgeHits=new h(e,t),this.dodgeHits.generateWeaponCache();var s=document.getElementsByClassName("canvas-message-container")[0];setTimeout((function(){s.style.display="flex",i.dodgeHits.showGame(),i.dodgeHits.animateGame()}),3e3),window.addEventListener("keydown",(function(e){e.preventDefault(),i.dodgeHits.registerPlayerMoves(e),i.dodgeHits.gameOn||i.dodgeHits.closeGame(e)}))}},{key:"ckloseGame",value:function(){return this.lifeCount<=0&&(document.getElementById("lose-message").classList.add("shown"),!0)}},{key:"ckGameWin",value:function(){return"crown"===this.currRoom.value&&(document.getElementById("win-message").classList.add("shown"),!0)}}])&&m(t.prototype,i),s&&m(t,s),e}(),f=function(){var e,t=Array.from(document.getElementsByClassName("overlay")),i=Array.from(document.getElementsByClassName("room"));document.addEventListener("life-update",(function(){document.getElementsByClassName("life-count")[0].innerHTML=e.lifeCount})),document.addEventListener("commander-msg",(function(){var t=e.currRoom.r,i=e.currRoom.c;document.getElementsByClassName("suit-value-[".concat(t,",").concat(i,"]"))[0].innerHTML="The commander should be always near the king... the crown should be in an adjacent room"})),t.forEach((function(t){t.addEventListener("click",(function(){i.forEach((function(e){e.setAttribute("id","hidden")})),(e=new g).newGame(),t.classList.remove("shown")}))})),i.forEach((function(t){t.addEventListener("click",(function(){if(!e.dodgeHits){t.setAttribute("id","shown");var i=e.openRoom(t);i&&e.specialRooms(i)}}))}))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",f()):f()}]);
//# sourceMappingURL=main.js.map